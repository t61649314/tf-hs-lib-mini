<wxs src="../../lib/utils.wxs" module="utils"/>
<view wx:if="{{!loading}}" class="fine-tuning">
    <view class="head">
        <view class="title">微调建议</view>
    </view>
    <view class="sub-title" style="padding-top: 0" wx:if="{{similarDeckList.length}}">
        相似卡组中出现率最高和最低的卡(排名从上至下，左边为出现率高，右边为出现率低)
    </view>
    <view class="sug-card-wrap" wx:if="{{similarDeckList.length}}">
        <view class="add-card-wrap">
            <view class="card-item"
                  wx:for="{{suggestionsAddCardList}}"
                  wx:key="index">
                <view class="card-cost">{{item.info.cost}}</view>
                <view class="card-name card-name-{{item.info.rarity}}">{{item.info.cnName}}</view>
                <view class="card-img-wrap">
                    <image class="card-img" mode="aspectFit"
                           src="https://cdn.tempostorm.com/cards/{{utils.formatImageUrl(item.info.img)}}"/>
                </view>
                <view class="card-add">
                    <text>+</text>
                </view>
            </view>
        </view>
        <view class="remove-card-wrap">
            <view class="card-item"
                  wx:for="{{suggestionsRemoveCardsList}}"
                  wx:key="index">
                <view class="card-cost">{{item.info.cost}}</view>
                <view class="card-name card-name-{{item.info.rarity}}">{{item.info.cnName}}</view>
                <view class="card-img-wrap">
                    <image class="card-img" mode="aspectFit"
                           src="https://cdn.tempostorm.com/cards/{{utils.formatImageUrl(item.info.img)}}"/>
                </view>
                <view class="card-remove">
                    <text>-</text>
                </view>
            </view>
        </view>
    </view>
    <view class="sub-title" wx:if="{{deckWeakenCardList.length}}">
        已经被削弱的卡
    </view>
    <view class="sug-card-wrap" wx:if="{{deckWeakenCardList.length}}">
        <view class="any-card-wrap">
            <view class="card-item"
                  wx:for="{{deckWeakenCardList}}"
                  wx:key="index">
                <view class="card-cost">{{item.cost}}</view>
                <view class="card-name card-name-{{item.rarity}}">{{item.cnName}}</view>
                <view class="card-img-wrap">
                    <image class="card-img" mode="aspectFit"
                           src="https://cdn.tempostorm.com/cards/{{utils.formatImageUrl(item.img)}}"/>
                </view>
                <view class="card-remove">
                    <text>-</text>
                </view>
            </view>
        </view>
    </view>
    <view class="sub-title" wx:if="{{newVersionCardList.length}}">
        当前卡组构筑时间之后才上线的其他版本（点击版本名查看当前职业的人气单卡，已经剔除根据相似卡组推荐的卡和已经削弱的卡）
    </view>
    <view class="version-list" wx:if="{{newVersionCardList.length}}">
        <view wx:for="{{newVersionCardList}}" wx:key="{{index}}">
            <view class="item {{item.isOpen?'item-open':'item-close'}}" data-index="{{index}}"
                  bindtap='versionItemClick'>
                <image class="version-img" src="../../images/version-icon/{{item.id}}.png"></image>
                <div class="title">{{item.title}}</div>
            </view>
            <view class="sug-card-wrap" wx:if="{{item.isOpen}}" style="padding: 20rpx 10rpx">
                <view class="any-card-wrap">
                    <view class="card-item"
                          wx:for="{{item.hotCardWeightList}}"
                          wx:key="index"
                          wx:for-item="cardItem">
                        <view class="card-cost">{{cardItem.info.cost}}</view>
                        <view class="card-name card-name-{{cardItem.info.rarity}}">{{cardItem.info.cnName}}</view>
                        <view class="card-img-wrap">
                            <image class="card-img" mode="aspectFit"
                                   src="https://cdn.tempostorm.com/cards/{{utils.formatImageUrl(cardItem.info.img)}}"/>
                        </view>
                        <view class="card-add">
                            <text>+</text>
                        </view>
                    </view>
                </view>
            </view>
        </view>
    </view>
    <view class="no-data-content"
          wx:if="{{!newVersionCardList.length&&!deckWeakenCardList.length&&!similarDeckList.length}}">
        暂无数据
    </view>

    <view class="head">
        <view class="title">相似卡组</view>
    </view>
    <view class="similar-deck-wrap" wx:if="{{similarDeckList.length}}">
        <navigator class="item" wx:for="{{similarDeckList}}" wx:key="{{index}}"
                   url="{{'../deckDetail/index?id='+item.deck._id+'&time='+item.deck.time+'&name='+item.deck.name}}"
                   open-type="navigate">
            <image class="item-occupation-icon" src="{{'../../images/'+item.deck.occupation+'-icon.png'}}"></image>
            <div class="item-name">{{item.deck.name}}</div>
            <div class="item-type">{{item.sameQuantity}}张相同卡</div>
            <div class="item-page">{{item.deck.page}}</div>
            <div class="item-time">{{item.deck.timeStr}}</div>
        </navigator>
    </view>
    <view class="no-data-content" wx:else>
        暂无数据
    </view>
</view>
<i-spin size="large" fix custom wx:if="{{loading}}">
    <i-icon type="refresh" size="20" i-class="icon-load"></i-icon>
    加载中...
</i-spin>